# Создание двух билдов из одного кода

## Как это работает

Один код → два разных билда:
- **SSR билд** - для серверного рендеринга (Vercel, Railway, etc.)
- **Статический билд** - для статических сайтов (GitHub Pages, Netlify, etc.)

## Команды

### Разработка
```bash
# SSR режим (по умолчанию)
yarn dev
# или
yarn dev:ssr

# Статический режим
yarn dev:static
```

### Создание билдов
```bash
# SSR билд
yarn build:ssr

# Статический билд
yarn build:static

# Оба билда сразу
yarn build:both
```

### Запуск продакшн
```bash
# SSR сервер
yarn start:ssr

# Обычный запуск (автоопределение)
yarn start
```

## Что происходит

### При создании SSR билда:
1. `NEXT_USE_SSR=true` → используется `getServerSideProps`
2. Конфигурация без `output: 'export'`
3. Оптимизированные изображения
4. Результат в `.next/`

### При создании статического билда:
1. `NEXT_USE_SSR=false` → используется `getStaticProps`
2. Конфигурация с `output: 'export'`
3. Неоптимизированные изображения (`unoptimized: true`)
4. Результат в `out/`

## Деплой

### SSR (Vercel, Railway, etc.):
```bash
yarn build:ssr
# Деплой папки .next/ на платформу с Node.js
```

### Статика (GitHub Pages, Netlify, etc.):
```bash
yarn build:static
# Деплой папки out/ на статический хостинг
```

## Файлы

- `scripts/build-config.js` - динамическая конфигурация
- `next.config.ts` - генерируется автоматически
- `pages/*.tsx` - один код для обоих режимов

## Преимущества

✅ **Один код** - никакого дублирования  
✅ **Автоматическое переключение** - через env-переменную  
✅ **Оптимизированные билды** - каждый под свою платформу  
✅ **Простота деплоя** - разные команды для разных хостингов 